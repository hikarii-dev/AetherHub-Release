<!--
    Aether Hub - Key Verification API
    
    This is a simple HTML page that acts as an API endpoint.
    The Discord bot will update a JSON file that this page reads.
    
    Host this on GitHub Pages or any static hosting.
-->

<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Aether Hub API</title>
    <script>
        // This will be called from Roblox Hub via HttpGet
        async function verifyKey(key, game) {
            try {
                // Fetch keys database from GitHub
                const response = await fetch('https://raw.githubusercontent.com/hikarii-dev/AetherHub-Release/main/api/keys.json');
                const data = await response.json();
                
                // Check if key exists
                if (data.keys[key]) {
                    const keyData = data.keys[key];
                    
                    // Check if expired
                    if (keyData.expires === null || Date.now() / 1000 < keyData.expires) {
                        // Valid key
                        return {
                            valid: true,
                            expires: keyData.expires,
                            duration: keyData.duration,
                            game: keyData.game
                        };
                    } else {
                        // Expired
                        return { valid: false, reason: 'expired' };
                    }
                } else {
                    // Key not found
                    return { valid: false, reason: 'not_found' };
                }
            } catch (error) {
                return { valid: false, reason: 'error', message: error.message };
            }
        }
        
        // Parse URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const key = urlParams.get('key');
        const game = urlParams.get('game');
        
        if (key && game) {
            verifyKey(key, game).then(result => {
                document.body.innerHTML = JSON.stringify(result);
            });
        } else {
            document.body.innerHTML = JSON.stringify({
                error: 'Missing parameters',
                usage: 'api.html?key=YOUR_KEY&game=GAME_ID'
            });
        }
    </script>
</head>
<body>
    <p>Loading...</p>
</body>
</html>
